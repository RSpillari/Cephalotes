glmmTMB(Composition~Forest+Size+Farm, family = "gaussian",data=paisagem)->result
AIC(result)->akai
summary(result)[[12]]->coefs
summary(result)[[12]]
summary(result)
for (h in buffer_distance_meters ) {
paisagem<-pred_table_pad[pred_table_pad$Scale==h,]
paisagem$Composition<-resp_table$PCoA1
glmmTMB(Composition~Forest+Size+(1|Farm), family = "gaussian",data=paisagem)->result
AIC(result)->akai
summary(result)[[12]]->coefs
data.frame(coefs,RsquareAdj(result),aic=akai,scale=h)->values3[[length(values3)+1]]
}
paisagem<-pred_table_pad[pred_table_pad$Scale==h,]
paisagem$Composition<-resp_table$PCoA1
glmmTMB(Composition~Forest+Size+(1|Farm), family = "gaussian",data=paisagem)->result
AIC(result)->akai
summary(result)
summary(result)[[6]]
#### Scale of effect - Species Composition ####
values3<-{}
for (h in buffer_distance_meters ) {
paisagem<-pred_table_pad[pred_table_pad$Scale==h,]
paisagem$Composition<-resp_table$PCoA1
glmmTMB(Composition~Forest+Size+(1|Farm), family = "gaussian",data=paisagem)->result
AIC(result)->akai
summary(result)[[6]]->coefs
data.frame(coefs$cond,RsquareAdj(result),aic=akai,scale=h)->values3[[length(values3)+1]]
}
RsquareAdj
RsquareAdj(result)
library(glmmTMB)
library(MuMIn)
#### Scale of effect - Species Richness ####
values<-{}
#### Scale of effect - Species Composition ####
values3<-{}
for (h in buffer_distance_meters ) {
paisagem<-pred_table_pad[pred_table_pad$Scale==h,]
paisagem$Composition<-resp_table$PCoA1
glmmTMB(Composition~Forest+Size+(1|Farm), family = "gaussian",data=paisagem)->result
AIC(result)->akai
summary(result)[[6]]->coefs
data.frame(coefs$cond,rsquare=r.squaredGLMM(result),aic=akai,scale=h)->values3[[length(values3)+1]]
}
do.call(rbind,values3)->valuesCOM
valuesCOM$Pr...t..<0.05->valuesCOM$p; valuesCOM
write.csv(valuesCOM,"values_Composition.csv",row.names = T) # Save
valuesCOM
valuesCOM
valuesCOM$Pr...z..<0.05->valuesCOM$p; valuesCOM
valuesCOM
paisagem_com<-pred_table_pad[pred_table_pad$Scale=="1500",] # Scale of effect = 1500
model_comp<-glmmTMB(Composition ~ Forest + Size (1|Farm) , family = "gaussian", data=table_comp)
model_comp<-glmmTMB(Composition ~ Forest + Size + (1|Farm) , family = "gaussian", data=table_comp)
summary(model_comp)
r.squaredGLMM(model_comp)
glmmTMB(Richness~Forest+Size (1|Farm), family = "gaussian",data=paisagem)->result
#### Scale of effect - Species Richness ####
values<-{}
for (h in buffer_distance_meters ) {
paisagem<-pred_table_pad[pred_table_pad$Scale==h,]
paisagem$Richness<-resp_table$Richness
glmmTMB(Richness~Forest+Size (1|Farm), family = "gaussian",data=paisagem)->result
AIC(result)->akai
summary(result)[[6]]->coefs
data.frame(coefs$cond,rsquare=r.squaredGLMM(result),aic=akai,scale=h)->values[[length(values)+1]]
}
glmmTMB(Richness~Forest+Size+ (1|Farm), family = "gaussian",data=paisagem)->result
for (h in buffer_distance_meters ) {
paisagem<-pred_table_pad[pred_table_pad$Scale==h,]
paisagem$Richness<-resp_table$Richness
glmmTMB(Richness~Forest+Size+ (1|Farm), family = "gaussian",data=paisagem)->result
AIC(result)->akai
summary(result)[[6]]->coefs
data.frame(coefs$cond,rsquare=r.squaredGLMM(result),aic=akai,scale=h)->values[[length(values)+1]]
}
do.call(rbind,values)->valuesR
valuesR$Pr...z..<0.5->valuesR$p ;valuesR
write.csv(valuesR,"values_Richness.csv",row.names = T) # Save #
paisagem_rich<-pred_table_pad[pred_table_pad$Scale=="2000",] # Scale of effect = 2000
#### Final Model - Species Richness ####
cbind(paisagem_rich,Richness=resp_table$Richness)->table_richall
model_rich<-glmMTMB(Richness ~ Forest + Size (1|Farm), family = "gaussian", data=table_richall)
model_rich<-glmmTMB(Richness ~ Forest + Size (1|Farm), family = "gaussian", data=table_richall)
summary(model_rich)
RsquareAdj(model_rich)
summary(model_rich)
valuesR$Pr...z..<0.05->valuesR$p ;valuesR
paisagem_rich<-pred_table_pad[pred_table_pad$Scale=="2000",] # Scale of effect = 2000
#### Final Model - Species Richness ####
cbind(paisagem_rich,Richness=resp_table$Richness)->table_richall
model_rich<-glmmTMB(Richness ~ Forest + Size (1|Farm), family = "gaussian", data=table_richall)
model_rich<-glmmTMB(Richness ~ Forest + Size +(1|Farm), family = "gaussian", data=table_richall)
summary(model_rich)
RsquareAdj(model_rich)
valuesR
valuesCOM
model_comp<-glmmTMB(Composition ~ Forest + Size + (1|Farm) , family = "gaussian", data=table_comp)
summary(model_comp)
r.squaredGLMM(model_comp)
summary(model_rich)
RsquareAdj(model_rich)
model_rich<-glmmTMB(Richness ~ Forest + Size +(1|Farm), family = "gaussian", data=table_richall)
summary(model_rich)
r.squaredGLMM(model_rich)
#### Scale of effect - Species Composition ####
values3<-{}
for (h in buffer_distance_meters ) {
paisagem<-pred_table_pad[pred_table_pad$Scale==h,]
paisagem$Composition<-resp_table$PCoA1
glmmTMB(Composition~Forest+Size+(1|Farm), family = "gaussian",data=paisagem)->result
AIC(result)->akai
summary(result)[[6]]->coefs
data.frame(coefs$cond,rsquare=r.squaredGLMM(result),aic=akai,scale=h)->values3[[length(values3)+1]]
}
do.call(rbind,values3)->valuesCOM
valuesCOM$Pr...z..<0.05->valuesCOM$p; valuesCOM
write.csv(valuesCOM,"values_Composition.csv",row.names = T) # Save
paisagem_com<-pred_table_pad[pred_table_pad$Scale=="1500",] # Scale of effect = 1500
#### Final Models - Species Composition ####
cbind(paisagem_com,Composition=resp_table$PCoA1)->table_comp
model_comp<-glmmTMB(Composition ~ Forest + Size + (1|Farm) , family = "gaussian", data=table_comp)
summary(model_comp)
r.squaredGLMM(model_comp)
pcoa
#### Final Model - Species Richness ####
cbind(paisagem_rich,Richness=resp_table$Richness)->table_richall
model_rich<-glmmTMB(Richness ~ Forest + Size +(1|Farm), family = "gaussian", data=table_richall)
summary(model_rich)
r.squaredGLMM(model_rich)
richplot<-ggplot(data=pred_data_rich,mapping = aes(x = Forest, y = Richness,size=Size))+
geom_smooth(method=lm, color='black',size=1,linewidth=0.6, se=F)+
geom_point(data= pred_data_rich,aes(shape = Farm, size = Size))+
scale_size_continuous(breaks = c(1, 10, 100), range = c(3,6.5)) +
labs(x="", y="Species\nRichness", shape= "Farm", size= "Patch size")+
theme_classic()+
scale_y_continuous("Species\nRichness",n.breaks = 8)+
theme(strip.text=element_text(family="sans",size=12,face="bold",hjust = 0),strip.background = element_rect(fill="white",colour = "white"),axis.text =element_text(family="sans",size=12),axis.title = element_text(family="sans",size=14,face="bold",),legend.position = "bottom" ,legend.text =element_text(family="sans",size=12,hjust = 0),legend.title =element_text(family="sans",size=12,face="bold",hjust = 0),legend.text.align = 1, legend.justification = "center",legend.box = "vertical"); richplot
library(ggplot2)
### Library required packages ###
library(sp)
library(sf)
library(raster)
library(vegan)
library(betapart)
library(bipartite)
library(ggplot2)
library(ggpubr)
library(TITAN2)
library(ggrepel)
library(reshape2)
library(glmmTMB)
library(MuMIn)
## Figure Richness x Habitat amount X Patch size ####
# Plot Species Richness
pred_table[pred_table$Scale==2000,]->pred_data_rich
pred_data_rich$Richness<-resp_table$Richness
richplot<-ggplot(data=pred_data_rich,mapping = aes(x = Forest, y = Richness,size=Size))+
geom_smooth(method=lm, color='black',size=1,linewidth=0.6, se=F)+
geom_point(data= pred_data_rich,aes(shape = Farm, size = Size))+
scale_size_continuous(breaks = c(1, 10, 100), range = c(3,6.5)) +
labs(x="", y="Species\nRichness", shape= "Farm", size= "Patch size")+
theme_classic()+
scale_y_continuous("Species\nRichness",n.breaks = 8)+
theme(strip.text=element_text(family="sans",size=12,face="bold",hjust = 0),strip.background = element_rect(fill="white",colour = "white"),axis.text =element_text(family="sans",size=12),axis.title = element_text(family="sans",size=14,face="bold",),legend.position = "bottom" ,legend.text =element_text(family="sans",size=12,hjust = 0),legend.title =element_text(family="sans",size=12,face="bold",hjust = 0),legend.text.align = 1, legend.justification = "center",legend.box = "vertical"); richplot
# Plot Composition
pred_table[pred_table$Scale==1500,]->pred_data_comp
pred_data_comp$Composition<-resp_table$PCoA1
pred_data_comp$Composition2<-resp_table$PCoA2
compplot<-ggplot(data=pred_data_comp,mapping = aes(x = Forest, y = pred_data_comp$Composition*-1,size = Size))+
geom_smooth(method=lm, color='black',size=1,linewidth=0.6, se=F)+
geom_point(data= pred_data_rich,aes(shape = Farm, size = Size))+
scale_size_continuous(breaks = c(1, 10, 100), range = c(3,6.5)) +
labs(x="Landscape habitat amount", y="Composition",shape= "Farm", size= "Patch size")+
theme_classic()+
scale_y_continuous("Species \nComposition",n.breaks = 8)+
theme(strip.text=element_text(family="sans",size=12,face="bold",hjust = 0),strip.background = element_rect(fill="white",colour = "white"),axis.text =element_text(family="sans",size=12),axis.title = element_text(family="sans",size=14,face="bold",),legend.text =element_text(family="sans",size=12,hjust = 0),legend.title =element_text(family="sans",size=12,face="bold",hjust = 0),legend.text.align = 1, legend.justification = "center",legend.position = "bottom" ,legend.box = "vertical"); compplot
# Plot Final
figure<-ggarrange(richplot,compplot,
common.legend = T, legend="bottom",
labels= c("(a)","(b)"),
ncol= 1, nrow=2,
align = "hv",
font.label = list(size = 14, color = "black", face = "bold", family = "sans", position = "top")); figure
# Save #
tiff("Habitat amount.tiff",width = 5,height = 7, units = "in",res = 600)
figure
dev.off()
dev.off()
# Save #
tiff("Habitat amount.tiff",width = 5,height = 7, units = "in",res = 600)
figure
dev.off()
dev.off()
dev.off()
dev.off()
# Save #
tiff("Habitat amount.tiff",width = 5,height = 7, units = "in",res = 600)
figure
dev.off()
dev.off()
figure
dev.off()
# Save #
tiff("Habitat amount.tiff",width = 5,height = 7, units = "in",res = 600)
figure
dev.off()
# Save #
tiff("Habitat amount.tiff",width = 5,height = 7, units = "in",res = 600)
figure
dev.off()
# Plot Final
figure<-ggarrange(richplot,compplot,
common.legend = T, legend="bottom",
labels= c("(a)","(b)"),
ncol= 1, nrow=2,
align = "hv",
font.label = list(size = 14, color = "black", face = "bold", family = "sans", position = "top")); figure
compplot<-ggplot(data=pred_data_comp,mapping = aes(x = Forest, y = Composition*-1,size = Size))+
geom_smooth(method=lm, color='black',size=1,linewidth=0.6, se=F)+
geom_point(data= pred_data_rich,aes(shape = Farm, size = Size))+
scale_size_continuous(breaks = c(1, 10, 100), range = c(3,6.5)) +
labs(x="Landscape habitat amount", y="Composition",shape= "Farm", size= "Patch size")+
theme_classic()+
scale_y_continuous("Species \nComposition",n.breaks = 8)+
theme(strip.text=element_text(family="sans",size=12,face="bold",hjust = 0),strip.background = element_rect(fill="white",colour = "white"),axis.text =element_text(family="sans",size=12),axis.title = element_text(family="sans",size=14,face="bold",),legend.text =element_text(family="sans",size=12,hjust = 0),legend.title =element_text(family="sans",size=12,face="bold",hjust = 0),legend.text.align = 1, legend.justification = "center",legend.position = "bottom" ,legend.box = "vertical"); compplot
compplot<-ggplot(data=pred_data_comp,mapping = aes(x = Forest, y = Composition*-1,size = Size))+
geom_smooth(method=lm, color='black',size=1,linewidth=0.6, se=F)+
geom_point(data= pred_data_rich,aes(shape = Farm, size = Size))+
scale_size_continuous(breaks = c(1, 10, 100), range = c(3,6.5)) +
labs(x="Landscape habitat amount", y="Composition",shape= "Farm", size= "Patch size")+
theme_classic()+
scale_y_continuous("Species \nComposition",n.breaks = 8)+
theme(strip.text=element_text(family="sans",size=12,face="bold",hjust = 0),strip.background = element_rect(fill="white",colour = "white"),axis.text =element_text(family="sans",size=12),axis.title = element_text(family="sans",size=14,face="bold",),legend.text =element_text(family="sans",size=12,hjust = 0),legend.title =element_text(family="sans",size=12,face="bold",hjust = 0),legend.text.align = 1, legend.justification = "center",legend.position = "bottom" ,legend.box = "vertical"); compplot
pred_data_comp
compplot<-ggplot(data=pred_data_comp,mapping = aes(x = Forest, y = Composition *-1,size = Size))+
geom_smooth(method=lm, color='black',size=1,linewidth=0.6, se=F)+
geom_point(data= pred_data_rich,aes(shape = Farm, size = Size))+
scale_size_continuous(breaks = c(1, 10, 100), range = c(3,6.5)) +
labs(x="Landscape habitat amount", y="Composition",shape= "Farm", size= "Patch size")+
theme_classic()+
scale_y_continuous("Species \nComposition",n.breaks = 8)+
theme(strip.text=element_text(family="sans",size=12,face="bold",hjust = 0),strip.background = element_rect(fill="white",colour = "white"),axis.text =element_text(family="sans",size=12),axis.title = element_text(family="sans",size=14,face="bold",),legend.text =element_text(family="sans",size=12,hjust = 0),legend.title =element_text(family="sans",size=12,face="bold",hjust = 0),legend.text.align = 1, legend.justification = "center",legend.position = "bottom" ,legend.box = "vertical"); compplot
compplot<-ggplot(data=pred_data_comp,mapping = aes(x = Forest, y = Composition*-1,size = Size))+
geom_smooth(method=lm, color='black',size=1,linewidth=0.6, se=F)+
geom_point(data= pred_data_rich,aes(shape = Farm, size = Size))+
scale_size_continuous(breaks = c(1, 10, 100), range = c(3,6.5)) +
labs(x="Landscape habitat amount", y="Composition",shape= "Farm", size= "Patch size")+
theme_classic()+
scale_y_continuous("Species \nComposition",n.breaks = 8)+
theme(strip.text=element_text(family="sans",size=12,face="bold",hjust = 0),strip.background = element_rect(fill="white",colour = "white"),axis.text =element_text(family="sans",size=12),axis.title = element_text(family="sans",size=14,face="bold",),legend.text =element_text(family="sans",size=12,hjust = 0),legend.title =element_text(family="sans",size=12,face="bold",hjust = 0),legend.text.align = 1, legend.justification = "center",legend.position = "bottom" ,legend.box = "vertical"); compplot
compplot<-ggplot(data=pred_data_comp,mapping = aes(x = Forest, y = pred_data_comp$Composition*-1,size = Size))+
geom_smooth(method=lm, color='black',size=1,linewidth=0.6, se=F)+
geom_point(data= pred_data_rich,aes(shape = Farm, size = Size))+
scale_size_continuous(breaks = c(1, 10, 100), range = c(3,6.5)) +
labs(x="Landscape habitat amount", y="Composition",shape= "Farm", size= "Patch size")+
theme_classic()+
scale_y_continuous("Species \nComposition",n.breaks = 8)+
theme(strip.text=element_text(family="sans",size=12,face="bold",hjust = 0),strip.background = element_rect(fill="white",colour = "white"),axis.text =element_text(family="sans",size=12),axis.title = element_text(family="sans",size=14,face="bold",),legend.text =element_text(family="sans",size=12,hjust = 0),legend.title =element_text(family="sans",size=12,face="bold",hjust = 0),legend.text.align = 1, legend.justification = "center",legend.position = "bottom" ,legend.box = "vertical"); compplot
# Plot Final
figure<-ggarrange(richplot,compplot,
common.legend = T, legend="bottom",
labels= c("(a)","(b)"),
ncol= 1, nrow=2,
align = "hv",
font.label = list(size = 14, color = "black", face = "bold", family = "sans", position = "top")); figure
# Save #
tiff("Habitat amount.tiff",width = 5,height = 7, units = "in",res = 600)
figure
dev.off()
compplot<-ggplot(data=pred_data_comp,mapping = aes(x = Forest, y = pred_data_comp$Composition*-1,size = Size))+
geom_smooth(method=lm, color='black',size=1,linewidth=0.6, se=F)+
geom_point(data= pred_data_rich,aes(shape = Farm, size = Size))+
scale_size_continuous(breaks = c(1, 10, 100), range = c(3,6.5)) +
labs(x="Landscape habitat amount", y="Composition",shape= "Farm", size= "Patch size")+
theme_classic()+
scale_y_continuous("Species \nComposition",n.breaks = 8)+
scale_x_continuous("Landscape Habitat Amount", n.breaks = 5)+
theme(strip.text=element_text(family="sans",size=12,face="bold",hjust = 0),strip.background = element_rect(fill="white",colour = "white"),axis.text =element_text(family="sans",size=12),axis.title = element_text(family="sans",size=14,face="bold",),legend.text =element_text(family="sans",size=12,hjust = 0),legend.title =element_text(family="sans",size=12,face="bold",hjust = 0),legend.text.align = 1, legend.justification = "center",legend.position = "bottom" ,legend.box = "vertical"); compplot
compplot<-ggplot(data=pred_data_comp,mapping = aes(x = Forest, y = pred_data_comp$Composition*-1,size = Size))+
geom_smooth(method=lm, color='black',size=1,linewidth=0.6, se=F)+
geom_point(data= pred_data_rich,aes(shape = Farm, size = Size))+
scale_size_continuous(breaks = c(1, 10, 100), range = c(3,6.5)) +
labs(x="Landscape habitat amount", y="Composition",shape= "Farm", size= "Patch size")+
theme_classic()+
scale_y_continuous("Species \nComposition",n.breaks = 8)+
scale_x_continuous("Landscape Habitat Amount", n.breaks = 6)+
theme(strip.text=element_text(family="sans",size=12,face="bold",hjust = 0),strip.background = element_rect(fill="white",colour = "white"),axis.text =element_text(family="sans",size=12),axis.title = element_text(family="sans",size=14,face="bold",),legend.text =element_text(family="sans",size=12,hjust = 0),legend.title =element_text(family="sans",size=12,face="bold",hjust = 0),legend.text.align = 1, legend.justification = "center",legend.position = "bottom" ,legend.box = "vertical"); compplot
# Plot Final
figure<-ggarrange(richplot,compplot,
common.legend = T, legend="bottom",
labels= c("(a)","(b)"),
ncol= 1, nrow=2,
align = "hv",
font.label = list(size = 14, color = "black", face = "bold", family = "sans", position = "top")); figure
# Save #
tiff("Habitat amount.tiff",width = 5,height = 7, units = "in",res = 600)
figure
dev.off()
dev.off()
# Save #
tiff("Habitat amount.tiff",width = 5,height = 7, units = "in",res = 600)
figure
dev.off()
# Save #
tiff("Habitat amount.tiff",width = 5,height = 7, units = "in",res = 600)
figure
dev.off()
compplot<-ggplot(data=pred_data_comp,mapping = aes(x = Forest, y = pred_data_comp$Composition*-1,size = Size))+
geom_smooth(method=lm, color='black',size=1,linewidth=0.6, se=F)+
geom_point(data= pred_data_rich,aes(shape = Farm, size = Size))+
scale_size_continuous(breaks = c(1, 10, 100), range = c(3,6.5)) +
labs(x="Landscape habitat amount", y="Composition",shape= "Farm", size= "Patch size")+
theme_classic()+
scale_y_continuous("Species \nComposition",n.breaks = 8)+
scale_x_continuous("Landscape Habitat Amount", n.breaks = 6)+
theme(strip.text=element_text(family="sans",size=12,face="bold",hjust = 0),strip.background = element_rect(fill="white",colour = "white"),axis.text =element_text(family="sans",size=12),axis.title = element_text(family="sans",size=14,face="bold",),legend.text =element_text(family="sans",size=12,hjust = 0),legend.title =element_text(family="sans",size=12,face="bold",hjust = 0),legend.text.align = 1, legend.justification = "center",legend.position = "bottom" ,legend.box = "vertical"); compplot
# Plot Final
figure<-ggarrange(richplot,compplot,
common.legend = T, legend="bottom",
labels= c("(a)","(b)"),
ncol= 1, nrow=2,
align = "hv",
font.label = list(size = 14, color = "black", face = "bold", family = "sans", position = "top")); figure
# Save #
tiff("Habitat amount.tiff",width = 5,height = 7, units = "in",res = 600)
figure
dev.off()
compplot<-ggplot(data=pred_data_comp,mapping = aes(x = Forest, y = pred_data_comp$Composition*-1,size = Size))+
geom_smooth(method=glm, color='black',size=1,linewidth=0.6, se=F)+
geom_point(data= pred_data_rich,aes(shape = Farm, size = Size))+
scale_size_continuous(breaks = c(1, 10, 100), range = c(3,6.5)) +
labs(x="Landscape habitat amount", y="Composition",shape= "Farm", size= "Patch size")+
theme_classic()+
scale_y_continuous("Species \nComposition",n.breaks = 8)+
scale_x_continuous("Landscape Habitat Amount", n.breaks = 6)+
theme(strip.text=element_text(family="sans",size=12,face="bold",hjust = 0),strip.background = element_rect(fill="white",colour = "white"),axis.text =element_text(family="sans",size=12),axis.title = element_text(family="sans",size=14,face="bold",),legend.text =element_text(family="sans",size=12,hjust = 0),legend.title =element_text(family="sans",size=12,face="bold",hjust = 0),legend.text.align = 1, legend.justification = "center",legend.position = "bottom" ,legend.box = "vertical"); compplot
compplot<-ggplot(data=pred_data_comp,mapping = aes(x = Forest, y = pred_data_comp$Composition*-1,size = Size))+
geom_smooth(method=lm, color='black',size=1,linewidth=0.6, se=F)+
geom_point(data= pred_data_rich,aes(shape = Farm, size = Size))+
scale_size_continuous(breaks = c(1, 10, 100), range = c(3,6.5)) +
labs(x="Landscape habitat amount", y="Composition",shape= "Farm", size= "Patch size")+
theme_classic()+
scale_y_continuous("Species \nComposition",n.breaks = 8)+
scale_x_continuous("Landscape Habitat Amount", n.breaks = 6)+
theme(strip.text=element_text(family="sans",size=12,face="bold",hjust = 0),strip.background = element_rect(fill="white",colour = "white"),axis.text =element_text(family="sans",size=12),axis.title = element_text(family="sans",size=14,face="bold",),legend.text =element_text(family="sans",size=12,hjust = 0),legend.title =element_text(family="sans",size=12,face="bold",hjust = 0),legend.text.align = 1, legend.justification = "center",legend.position = "bottom" ,legend.box = "vertical"); compplot
# Plot Composition
pred_table[pred_table$Scale==1500,]->pred_data_comp
pred_data_comp$Composition<-resp_table$PCoA1
pred_data_comp$Composition2<-resp_table$PCoA2
compplot<-ggplot(data=pred_data_comp,mapping = aes(x = Forest, y = pred_data_comp$Composition*-1,size = Size))+
geom_smooth(method=lm, color='black',size=1,linewidth=0.6, se=F)+
geom_point(data= pred_data_rich,aes(shape = Farm, size = Size))+
scale_size_continuous(breaks = c(1, 10, 100), range = c(3,6.5)) +
labs(x="Landscape habitat amount", y="Composition",shape= "Farm", size= "Patch size")+
theme_classic()+
scale_y_continuous("Species \nComposition",n.breaks = 8)+
scale_x_continuous("Landscape Habitat Amount", n.breaks = 6)+
theme(strip.text=element_text(family="sans",size=12,face="bold",hjust = 0),strip.background = element_rect(fill="white",colour = "white"),axis.text =element_text(family="sans",size=12),axis.title = element_text(family="sans",size=14,face="bold",),legend.text =element_text(family="sans",size=12,hjust = 0),legend.title =element_text(family="sans",size=12,face="bold",hjust = 0),legend.text.align = 1, legend.justification = "center",legend.position = "bottom" ,legend.box = "vertical"); compplot
pred_data_rich
## Figure Richness x Habitat amount X Patch size ####
# Plot Species Richness
pred_table[pred_table$Scale==2000,]->pred_data_rich
pred_data_rich$Richness<-resp_table$Richness
richplot<-ggplot(data=pred_data_rich,mapping = aes(x = Forest, y = Richness,size=Size))+
geom_smooth(method=lm, color='black',size=1,linewidth=0.6, se=F)+
geom_point(data= pred_data_rich,aes(shape = Farm, size = Size))+
scale_size_continuous(breaks = c(1, 10, 100), range = c(3,6.5)) +
labs(x="", y="Species\nRichness", shape= "Farm", size= "Patch size")+
theme_classic()+
scale_y_continuous("Species\nRichness",n.breaks = 8)+
theme(strip.text=element_text(family="sans",size=12,face="bold",hjust = 0),strip.background = element_rect(fill="white",colour = "white"),axis.text =element_text(family="sans",size=12),axis.title = element_text(family="sans",size=14,face="bold",),legend.position = "bottom" ,legend.text =element_text(family="sans",size=12,hjust = 0),legend.title =element_text(family="sans",size=12,face="bold",hjust = 0),legend.text.align = 1, legend.justification = "center",legend.box = "vertical"); richplot
# Plot Composition
pred_table[pred_table$Scale==1500,]->pred_data_comp
pred_data_comp
pred_data_rich
# Plot Final
figure<-ggarrange(richplot,compplot,
common.legend = T, legend="bottom",
labels= c("(a)","(b)"),
ncol= 1, nrow=2,
align = "hv",
font.label = list(size = 14, color = "black", face = "bold", family = "sans", position = "top")); figure
# Plot Final
figure<-ggarrange(richplot,compplot,
common.legend = T, legend="bottom",
labels= c("(a)","(b)"),
ncol= 1, nrow=2,
align = "hv",
font.label = list(size = 14, color = "black", face = "bold", family = "sans", position = "top")); figure
richplot
compplot
pred_data_comp$Composition2<-resp_table$PCoA2
compplot<-ggplot(data=pred_data_comp,mapping = aes(x = Forest, y = pred_data_comp$Composition*-1,size = Size))+
geom_smooth(method=lm, color='black',size=1,linewidth=0.6, se=F)+
geom_point(data= pred_data_rich,aes(shape = Farm, size = Size))+
scale_size_continuous(breaks = c(1, 10, 100), range = c(3,6.5)) +
labs(x="Landscape habitat amount", y="Composition",shape= "Farm", size= "Patch size")+
theme_classic()+
scale_y_continuous("Species \nComposition",n.breaks = 8)+
scale_x_continuous("Landscape Habitat Amount", n.breaks = 6)+
theme(strip.text=element_text(family="sans",size=12,face="bold",hjust = 0),strip.background = element_rect(fill="white",colour = "white"),axis.text =element_text(family="sans",size=12),axis.title = element_text(family="sans",size=14,face="bold",),legend.text =element_text(family="sans",size=12,hjust = 0),legend.title =element_text(family="sans",size=12,face="bold",hjust = 0),legend.text.align = 1, legend.justification = "center",legend.position = "bottom" ,legend.box = "vertical"); compplot
compplot<-ggplot(data=pred_data_comp,mapping = aes(x = Forest, y = pred_data_comp$Composition*-1,size = Size))+
geom_smooth(method=lm, color='black',size=1,linewidth=0.6, se=F)+
geom_point(data= pred_data_rich,aes(shape = Farm, size = Size))+
scale_size_continuous(breaks = c(1, 10, 100), range = c(3,6.5)) +
labs(x="Landscape habitat amount", y="Composition",shape= "Farm", size= "Patch size")+
theme_classic()+
scale_y_continuous("Species \nComposition",n.breaks = 8)+
scale_x_continuous("Landscape Habitat Amount", n.breaks = 6)
compplot<-ggplot(data=pred_data_comp,mapping = aes(x = Forest, y = pred_data_comp$Composition*-1,size = Size))+
geom_smooth(method=lm, color='black',size=1,linewidth=0.6, se=F)+
geom_point(data= pred_data_rich,aes(shape = Farm, size = Size))+
scale_size_continuous(breaks = c(1, 10, 100), range = c(3,6.5)) +
labs(x="Landscape habitat amount", y="Composition",shape= "Farm", size= "Patch size")+
theme_classic()+
scale_y_continuous("Species \nComposition",n.breaks = 8)+
scale_x_continuous("Landscape Habitat Amount", n.breaks = 6)+
theme(strip.text=element_text(family="sans",size=12,face="bold",hjust = 0),strip.background = element_rect(fill="white",colour = "white"),axis.text =element_text(family="sans",size=12),axis.title = element_text(family="sans",size=14,face="bold",),legend.text =element_text(family="sans",size=12,hjust = 0),legend.title =element_text(family="sans",size=12,face="bold",hjust = 0),legend.text.align = 1, legend.justification = "center",legend.position = "bottom" ,legend.box = "vertical"); compplot
# Plot Composition
pred_table[pred_table$Scale==1500,]->pred_data_comp
pred_data_comp$Composition<-resp_table$PCoA1
pred_data_comp$Composition2<-resp_table$PCoA2
compplot<-ggplot(data=pred_data_comp,mapping = aes(x = Forest, y = pred_data_comp$Composition*-1,size = Size))+
geom_smooth(method=lm, color='black',size=1,linewidth=0.6, se=F)+
geom_point(data= pred_data_rich,aes(shape = Farm, size = Size))+
scale_size_continuous(breaks = c(1, 10, 100), range = c(3,6.5)) +
labs(x="Landscape habitat amount", y="Composition",shape= "Farm", size= "Patch size")+
theme_classic()+
scale_y_continuous("Species \nComposition",n.breaks = 8)+
scale_x_continuous("Landscape Habitat Amount", n.breaks = 6)+
theme(strip.text=element_text(family="sans",size=12,face="bold",hjust = 0),strip.background = element_rect(fill="white",colour = "white"),axis.text =element_text(family="sans",size=12),axis.title = element_text(family="sans",size=14,face="bold",),legend.text =element_text(family="sans",size=12,hjust = 0),legend.title =element_text(family="sans",size=12,face="bold",hjust = 0),legend.text.align = 1, legend.justification = "center",legend.position = "bottom" ,legend.box = "vertical"); compplot
# Plot Final
figure<-ggarrange(richplot,compplot,
common.legend = T, legend="bottom",
labels= c("(a)","(b)"),
ncol= 1, nrow=2,
align = "hv",
font.label = list(size = 14, color = "black", face = "bold", family = "sans", position = "top")); figure
# Save #
tiff("Habitat amount.tiff",width = 5,height = 7, units = "in",res = 600)
figure
dev.off()
figscale<-ggplot(data=datarsquare,mapping=aes(x=scale,y=rsquare))+
geom_line(linetype="dashed")+
geom_point(size=3,aes(colour = cores))+
scale_color_manual(values = c("black","#ff3131"))+
guides(color="none")+
labs(x="Landscape Size", y="Adj. R²")+
scale_x_continuous(n.breaks = 8,)+
scale_y_continuous(n.breaks = 6)+
facet_wrap(.~plot,scales="free_y",nrow=2,ncol=1)+
theme_minimal()+
theme(strip.text=element_text(family="sans",size=12,face="bold",hjust = 0),strip.background = element_rect(fill="white",colour = "white"),axis.text =element_text(family="sans",size=12),axis.title = element_text(family="sans",size=14,face="bold"),legend.position = "right",legend.text =element_text(family="sans",size=12,hjust = 0),legend.title =element_text(family="sans",size=12,face="bold",hjust = 0),legend.text.align = 1,legend.justification = "top"); figscale
# Save
tiff("Scales_of_effect_all.tif",width = 4,height = 5, units = "in",res = 600)
figscale
dev.off()
value_cor2 # Correlation for each buff size #
#### Scale of effect - Species Richness ####
values<-{}
for (h in buffer_distance_meters ) {
paisagem<-pred_table_pad[pred_table_pad$Scale==h,]
paisagem$Richness<-resp_table$Richness
glmmTMB(Richness~Forest+Size+ (1|Farm), family = "gaussian",data=paisagem)->result
AIC(result)->akai
summary(result)[[6]]->coefs
data.frame(coefs$cond,rsquare=r.squaredGLMM(result),aic=akai,scale=h)->values[[length(values)+1]]
}
do.call(rbind,values)->valuesR
valuesR$Pr...z..<0.05->valuesR$p ;valuesR
write.csv(valuesR,"values_Richness.csv",row.names = T) # Save #
paisagem_rich<-pred_table_pad[pred_table_pad$Scale=="2000",] # Scale of effect = 2000
#### Final Model - Species Richness ####
cbind(paisagem_rich,Richness=resp_table$Richness)->table_richall
model_rich<-glmmTMB(Richness ~ Forest + Size +(1|Farm), family = "gaussian", data=table_richall)
summary(model_rich)
r.squaredGLMM(model_rich)
# Correlations
# Forest amount x Farm
aov(paisagem_rich$Forest~paisagem_rich$Farm)->anova
summary(anova)
TukeyHSD(anova)
# Richness x Farm
aov(table_richall$Richness~paisagem_rich$Farm)->resu
summary(resu)
TukeyHSD(resu)
#### Scale of effect - Species Composition ####
values3<-{}
for (h in buffer_distance_meters ) {
paisagem<-pred_table_pad[pred_table_pad$Scale==h,]
paisagem$Composition<-resp_table$PCoA1
glmmTMB(Composition~Forest+Size+(1|Farm), family = "gaussian",data=paisagem)->result
AIC(result)->akai
summary(result)[[6]]->coefs
data.frame(coefs$cond,rsquare=r.squaredGLMM(result),aic=akai,scale=h)->values3[[length(values3)+1]]
}
do.call(rbind,values3)->valuesCOM
valuesCOM$Pr...z..<0.05->valuesCOM$p; valuesCOM
write.csv(valuesCOM,"values_Composition.csv",row.names = T) # Save
paisagem_com<-pred_table_pad[pred_table_pad$Scale=="1500",] # Scale of effect = 1500
#### Final Models - Species Composition ####
cbind(paisagem_com,Composition=resp_table$PCoA1)->table_comp
model_comp<-glmmTMB(Composition ~ Forest + Size + (1|Farm) , family = "gaussian", data=table_comp)
summary(model_comp)
r.squaredGLMM(model_comp)
write.csv(valuesCOM,"values_Composition.csv",row.names = T) # Save
write.csv(valuesR,"values_Richness.csv",row.names = T) # Save #
write.csv(valuesR,"values_Richness.csv",row.names = T) # Save #
write.csv(valuesCOM,"values_Composition.csv",row.names = T) # Save
valuesCOM
